/**
 * Deobfuscated from jsjiami.com.v5
 * Clean & readable version
 */

/* ========== 请求阶段：修改请求头 ========== */

// 命中第一个 URL 特征
if ($request.url && $request.url.indexOf("android") !== -1) {
  let headers = $request.headers;
  headers["User-Agent"] = "okhttp/4.9.0";
  $done({ headers });
  return;
}

// 命中第二个 URL 特征
if ($request.url && $request.url.indexOf("ios") !== -1) {
  let headers = $request.headers;
  headers["User-Agent"] = "okhttp/4.9.0";
  $done({ headers });
  return;
}

/* ========== 响应阶段：修改返回体 ========== */

if ($response && $response.body && $request.url.indexOf("check") !== -1) {
  try {
    let obj = JSON.parse($response.body);

    // 原脚本实际只改了这两个字段
    obj.status = "9";
    obj.message = "success";

    $done({
      body: JSON.stringify(obj)
    });
  } catch (e) {
    $done({});
  }
  return;
}

/* ========== 兜底 ========== */
$done({});